var NodeHelper = require('node_helper');
var sensor = require("node-dht-sensor");

module.exports = NodeHelper.create({
	start: function() {
		this.sensors = [];
	},


	getSensorInformation: function(name) {
		console.log('Reading ' + name + ' which is of type ' + this.sensors[name].type + ' on input ' + this.sensors[name].input);
		return {
			"temp": 1,
			"humidity": 12
		};
	},

	socketNotificationReceived: function(notification, payload) {
		console.log(notification + " received");

		if (notification === 'REGISTER_SENSOR') {
			console.log('Registering sensor: ' + payload);
			this.sensors[payload.name] = {
				'type': payload.type,
				'input': payload.input
			};
			console.log(this.sensors);
			this.sendSocketNotification('REGISTERED_SENSOR', null);
		}
		else if( notification === 'SENSOR_INFO_REQ') {
			console.log('Sensor info needed for ' + payload);
			var data = this.getSensorInformation(payload);

			this.sendSocketNotification('SENSOR_INFO_RCV', data);
		}
	},
});

